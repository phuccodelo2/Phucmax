--// Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local VirtualInput = game:GetService("VirtualInputManager")
local LocalPlayer = Players.LocalPlayer

--// GUI
local gui = Instance.new("ScreenGui", game.CoreGui)
gui.Name = "BossFarmUI"

local main = Instance.new("Frame", gui)
main.Size = UDim2.new(0, 250, 0, 190)
main.Position = UDim2.new(0.01, 0, 0.4, 0)
main.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
main.BorderSizePixel = 0
main.Active = true
main.Draggable = true
main.BackgroundTransparency = 0
main.ClipsDescendants = true
main.BackgroundTransparency = 0
main.BorderColor3 = Color3.fromRGB(255, 255, 255)
main.BackgroundTransparency = 0
main.ZIndex = 2
main.Parent = gui
main:FindFirstChildOfClass("UICorner") or Instance.new("UICorner", main)

local title = Instance.new("TextLabel", main)
title.Size = UDim2.new(1, 0, 0, 30)
title.BackgroundTransparency = 1
title.Text = "PHUCBOSS FARM"
title.TextColor3 = Color3.fromRGB(255, 255, 0)
title.Font = Enum.Font.GothamBold
title.TextScaled = true
Instance.new("UICorner", title)

local toggleFarm = Instance.new("TextButton", main)
toggleFarm.Size = UDim2.new(1, -20, 0, 40)
toggleFarm.Position = UDim2.new(0, 10, 0, 40)
toggleFarm.Text = "Bật Farm Boss"
toggleFarm.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
toggleFarm.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleFarm.Font = Enum.Font.Gotham
toggleFarm.TextScaled = true
Instance.new("UICorner", toggleFarm)

local toggleClick = Instance.new("TextButton", main)
toggleClick.Size = UDim2.new(1, -20, 0, 40)
toggleClick.Position = UDim2.new(0, 10, 0, 90)
toggleClick.Text = "Bật Auto Click"
toggleClick.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
toggleClick.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleClick.Font = Enum.Font.Gotham
toggleClick.TextScaled = true
Instance.new("UICorner", toggleClick)

local hpLabel = Instance.new("TextLabel", gui)
hpLabel.Size = UDim2.new(0, 200, 0, 40)
hpLabel.Position = UDim2.new(1, -210, 0, 20)
hpLabel.Text = "HP: ???"
hpLabel.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
hpLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
hpLabel.Font = Enum.Font.GothamBold
hpLabel.TextScaled = true
hpLabel.Visible = false
Instance.new("UICorner", hpLabel)

--// Variables
local farming = false
local autoClicking = false
local NPC_NAME = "NPC2"
local TOOL_NAME = "phonglon"

--// Auto Equip Tool
local function equipTool()
    local Backpack = LocalPlayer:FindFirstChild("Backpack")
    if Backpack then
        local tool = Backpack:FindFirstChild(TOOL_NAME)
        if tool then
            LocalPlayer.Character.Humanoid:EquipTool(tool)
        end
    end
end

--// Get Nearest NPC
local function getNPC()
    for _, npc in pairs(workspace:GetDescendants()) do
        if npc:IsA("Model") and npc:FindFirstChild("Humanoid") and npc.Name == NPC_NAME then
            if npc:FindFirstChild("HumanoidRootPart") then
                return npc
            end
        end
    end
    return nil
end

--// Auto Click Real
local function autoClick()
    VirtualInput:SendMouseButtonEvent(500, 500, 0, true, game, 0)
    VirtualInput:SendMouseButtonEvent(500, 500, 0, false, game, 0)
end

--// Main Farm Loop
RunService.RenderStepped:Connect(function()
    if farming then
        equipTool()
        local npc = getNPC()
        if npc then
            local hrp = npc:FindFirstChild("HumanoidRootPart")
            local char = LocalPlayer.Character
            if hrp and char and char:FindFirstChild("HumanoidRootPart") then
                local myHRP = char.HumanoidRootPart
                -- Move in circle
                local angle = tick() * 2
                local offset = Vector3.new(math.cos(angle), 0, math.sin(angle)) * 22
                myHRP.CFrame = CFrame.new(hrp.Position + offset, hrp.Position)

                -- Face NPC
                myHRP.CFrame = CFrame.lookAt(myHRP.Position, hrp.Position)

                -- Show HP
                local hp = npc.Humanoid.Health
                local maxHp = npc.Humanoid.MaxHealth
                hpLabel.Text = "HP: " .. math.floor(hp) .. " / " .. math.floor(maxHp)
                hpLabel.Visible = true
            end
        else
            hpLabel.Text = "HP: ???"
            hpLabel.Visible = false
        end
    end
end)

--// Auto Click Loop
task.spawn(function()
    while true do
        if autoClicking then
            autoClick()
        end
        task.wait(0.2)
    end
end)

--// Button Toggle
toggleFarm.MouseButton1Click:Connect(function()
    farming = not farming
    toggleFarm.Text = farming and "Tắt Farm Boss" or "Bật Farm Boss"
end)

toggleClick.MouseButton1Click:Connect(function()
    autoClicking = not autoClicking
    toggleClick.Text = autoClicking and "Tắt Auto Click" or "Bật Auto Click"
end)
