-- UI & Variables
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local VirtualUser = game:GetService("VirtualUser")
local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")

local FarmEnabled = false
local UIVisible = true
local BossName = "NPC2"
local DistanceFromBoss = 22
local Speed = 0.3

-- Create ScreenGui
local gui = Instance.new("ScreenGui", game.CoreGui)
gui.Name = "FarmBossUI"

-- Toggle UI Button
local toggleUI = Instance.new("TextButton", gui)
toggleUI.Size = UDim2.new(0, 100, 0, 30)
toggleUI.Position = UDim2.new(0, 0, 0.4, 0)
toggleUI.Text = "Toggle UI"

-- Frame
local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 200, 0, 150)
frame.Position = UDim2.new(0, 0, 0.45, 0)
frame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
frame.Visible = true

-- Toggle Farm Button
local toggleFarm = Instance.new("TextButton", frame)
toggleFarm.Size = UDim2.new(0, 180, 0, 30)
toggleFarm.Position = UDim2.new(0, 10, 0, 10)
toggleFarm.Text = "Farm Boss: OFF"

-- Boss Health Label
local healthLabel = Instance.new("TextLabel", gui)
healthLabel.Size = UDim2.new(0, 200, 0, 30)
healthLabel.Position = UDim2.new(1, -210, 0.1, 0)
healthLabel.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
healthLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
healthLabel.Text = "Boss HP: ???"
healthLabel.TextScaled = true
healthLabel.Visible = true

-- UI Toggle Function
toggleUI.MouseButton1Click:Connect(function()
	UIVisible = not UIVisible
	frame.Visible = UIVisible
end)

-- Auto Farm Loop
RunService.Heartbeat:Connect(function()
	if FarmEnabled then
		local Boss = nil
		for _, npc in pairs(workspace:GetDescendants()) do
			if npc:IsA("Model") and npc.Name == BossName and npc:FindFirstChild("HumanoidRootPart") and npc:FindFirstChildOfClass("Humanoid") then
				Boss = npc
				break
			end
		end

		if Boss then
			local BossHRP = Boss:FindFirstChild("HumanoidRootPart")
			local humanoid = Boss:FindFirstChildOfClass("Humanoid")
			if BossHRP and humanoid then
				-- Hiển thị máu
				healthLabel.Text = "Boss HP: " .. math.floor(humanoid.Health)

				-- Di chuyển vòng quanh boss
				local angle = tick() * Speed
				local x = math.cos(angle) * DistanceFromBoss
				local z = math.sin(angle) * DistanceFromBoss
				local newPos = BossHRP.Position + Vector3.new(x, 0, z)

				HumanoidRootPart.CFrame = CFrame.new(newPos, BossHRP.Position)

				-- Click ảo
				VirtualUser:Button1Down(Vector2.new())
				task.wait(0.05)
				VirtualUser:Button1Up(Vector2.new())
			end
		end
	end
end)

-- Farm Toggle Button
toggleFarm.MouseButton1Click:Connect(function()
	FarmEnabled = not FarmEnabled
	toggleFarm.Text = "Farm Boss: " .. (FarmEnabled and "ON" or "OFF")
end)
